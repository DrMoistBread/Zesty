@page "/Table"
@inject IJSRuntime JS

<div class="flex flex-col items-center justify-center min-h-screen bg-gray-100">
    <h1 class="text-2xl font-bold mb-6 text-gray-800">QR Code Scanner</h1>

    <!-- Camera preview container -->
    <div id="reader" class="w-80 h-80 border-2 border-gray-300 rounded-lg shadow-md mb-4"></div>

    <!-- Result display -->
    <div class="bg-white p-4 rounded-lg shadow-md w-80 text-center">
        <p class="text-gray-700 font-semibold">Scanned Result:</p>
        <p class="text-blue-600 break-words">@_scannedResult</p>
    </div>

    <!-- Control buttons -->
    <div class="flex space-x-4 mt-6">
        <button @onclick="StartScanner"
                class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
            Start
        </button>
        <button @onclick="StopScanner"
                class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">
            Stop
        </button>
        
        <button @onclick='() => Console.WriteLine("Clicked!")'>Test</button>

    </div>
</div>


@code {
    private string _scannedResult = string.Empty;

    private DotNetObjectReference<TablePage>? objRef;
    
    protected override void OnInitialized()
    {
        objRef = DotNetObjectReference.Create(this);
    }
    
    [JSInvokable]
    public void OnQrScanned(string text)
    {
        Console.WriteLine("teste");
        _scannedResult = text;
        StateHasChanged();
    }

    private async Task StartScanner()
    {
        Console.WriteLine("StartScanner");
         await JS.InvokeVoidAsync("qrScanner.start", objRef);
    }

    private async Task StopScanner()
    {
        Console.WriteLine("StopScanner");

         await JS.InvokeVoidAsync("qrScanner.stop");
    }

}
